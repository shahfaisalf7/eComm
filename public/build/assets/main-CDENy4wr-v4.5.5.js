import{S as b,N as q}from"./swiper-BxwyBx_L-v4.5.5.js";import{n as w}from"./nouislider--DU6hECO-v4.5.5.js";import"./ProductCard-BSq6QDiW-v4.5.5.js";import"./Pagination-DKj6Zlmg-v4.5.5.js";import"./ProductMixin-DhU4KMUu-v4.5.5.js";import"./ProductRating-CAAvC5LN-v4.5.5.js";Alpine.data("ProductIndex",({initialQuery:o,initialBrandName:u,initialBrandBanner:n,initialBrandSlug:c,initialCategoryName:h,initialCategoryBanner:d,initialCategorySlug:P,initialTagName:p,initialTagSlug:g,initialAttribute:l,minPrice:i,maxPrice:e,initialSort:f,initialPage:a,initialPerPage:m,initialViewMode:y})=>({fetchingProducts:!1,products:{data:[]},attributeFilters:[],initialBrandName:u,initialTagName:p,brandBanner:n,categoryName:h,categoryBanner:d,viewMode:y,currentPage:a,queryParams:{query:o,brand:c,category:P,tag:g,attribute:l,fromPrice:0,toPrice:e,sort:f,perPage:m,page:a},get emptyProducts(){return this.products.data.length===0},get totalPage(){return Math.ceil(this.products.total/this.queryParams.perPage)},get showingResults(){if(!this.emptyProducts)return trans("storefront::products.showing_results",{from:this.products.from,to:this.products.to,total:this.products.total})},init(){this.initPriceFilter(),this.fetchProducts(),this.initLatestProductsSlider()},uid(){return Math.random().toString(36).slice(3)},changeSort(t){this.queryParams.sort=t,this.fetchProducts()},changePerPage(t){this.currentPage=1,this.queryParams.perPage=t,this.queryParams.page=1,this.fetchProducts()},initPriceFilter(){w.create(this.$refs.priceRange,{connect:!0,direction:window.FleetCart.rtl?"rtl":"ltr",start:[i,e],range:{min:[i],max:[e]}}),this.$refs.priceRange.noUiSlider.on("update",(t,r)=>{let s=Math.round(t[r]);r===0?this.queryParams.fromPrice=s:this.queryParams.toPrice=s}),this.$refs.priceRange.noUiSlider.on("change",()=>{this.fetchProducts()})},updatePriceRange(t,r){this.$refs.priceRange.noUiSlider.set([t,r]),this.fetchProducts()},toggleAttributeFilter(t,r){this.queryParams.attribute.hasOwnProperty(t)||(this.queryParams.attribute[t]=[]),this.queryParams.attribute[t].includes(r)?this.queryParams.attribute[t].splice(this.queryParams.attribute[t].indexOf(r),1):this.queryParams.attribute[t].push(r),this.fetchProducts({updateAttributeFilters:!1})},isFilteredByAttribute(t,r){return this.queryParams.attribute.hasOwnProperty(t)?this.queryParams.attribute[t].includes(r):!1},changePage(t){this.currentPage=t,this.queryParams.page=t,this.fetchProducts()},async fetchProducts(t={updateAttributeFilters:!0}){this.fetchingProducts=!0;try{const r=await axios.get(route("products.index",this.queryParams));this.products=r.data.products,t.updateAttributeFilters&&(this.attributeFilters=r.data.attributes),r.data.category&&(this.categoryName=r.data.category.name,this.categoryBanner=r.data.category.banner)}catch(r){notify(r.response.data.message)}finally{this.fetchingProducts=!1}},initLatestProductsSlider(){new b(this.$refs.latestProducts,{modules:[q],slidesPerView:1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})}}));
