import{S as o,M as d,N as l,T as y,P as w}from"./swiper-BxwyBx_L-v4.5.5.js";import{m as f}from"./blueimp-md5-Bk4TCVgI-v4.5.5.js";import{D as c}from"./drift-zoom-KJ3HkKpL-v4.5.5.js";import{G as b}from"./glightbox-2WdySglk-v4.5.5.js";import{E as P}from"./Errors-C30A2Jtx-v4.5.5.js";import"./ProductRating-JVo-DO-g-v4.5.5.js";import"./Pagination-DKj6Zlmg-v4.5.5.js";import"./ProductCard-Bvz-RVn_-v4.5.5.js";import"./@popperjs-ZDRvRZ2v-v4.5.5.js";import"./ProductMixin-CK9f42Ug-v4.5.5.js";let r,u,n=[];Alpine.data("ProductShow",({product:h,variant:m,reviewCount:p,avgRating:g})=>({product:h,item:m||h,addingToCart:!1,oldMediaLength:null,activeVariationValues:{},variationImagePath:null,showDescriptionContent:!1,showMore:!1,fetchingReviews:!1,reviews:{},reviewCount:p,avgRating:g,addingNewReview:!1,reviewForm:{},currentPage:1,cartItemForm:{product_id:h.id,qty:1,variations:{},options:{}},errors:new P,get productName(){return this.product.name},get isActiveItem(){return this.item.is_active===!0},get productUrl(){return route("products.show",{slug:this.product.slug,...this.hasAnyVariant&&{variant:this.item.uid}})},get orderProductCount(){return this.item?.order_products_count??0},get hasAnyMedia(){return this.item.media.length!==0},get productPrice(){return this.item.formatted_price},get isInStock(){return this.item.is_in_stock},get isOutOfStock(){return this.item.is_out_of_stock},get doesManageStock(){return this.item.does_manage_stock},get hasAnyVariationImage(){return this.variationImagePath!==null},get inWishlist(){return this.$store.state.inWishlist(this.product.id)},get inCompareList(){return this.$store.state.inCompareList(this.product.id)},get hasAnyVariant(){return this.product.variant!==null},get hasAnyOption(){return this.product.options.length>0},get isAddToCartDisabled(){return this.isActiveItem?this.isOutOfStock:!0},get maxQuantity(){return this.isInStock&&this.doesManageStock?this.item.qty:null},get isQtyIncreaseDisabled(){return this.isOutOfStock||this.maxQuantity!==null&&this.cartItemForm.qty>=this.item.qty||!this.isActiveItem},get isQtyDecreaseDisabled(){return this.isOutOfStock||this.cartItemForm.qty<=1||!this.isActiveItem},get totalReviews(){return this.reviews.total?this.reviews.total:this.reviewCount},get ratingPercent(){return this.avgRating/5*100},get emptyReviews(){return this.totalReviews===0},get totalPage(){return Math.ceil(this.reviews.total/5)},init(){r=this.initGalleryPreviewSlider(),u=this.initGalleryPreviewLightbox(),this.fetchReviews(),this.setOldMediaLength(),this.initGalleryPreviewZoom(),this.setActiveVariationsValue(),this.setDescriptionContentHeight(),this.initUpSellProductsSlider(),this.initRelatedProductsSlider()},syncWishlist(){this.$store.state.syncWishlist(this.product.id)},syncCompareList(){this.$store.state.syncCompareList(this.product.id)},setOldMediaLength(){this.hasAnyVariant&&(this.oldMediaLength=this.item.media.length)},initGalleryPreviewSlider(){return new o(".product-gallery-preview",{modules:[d,l,y],slidesPerView:1,allowTouchMove:!1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},thumbs:{swiper:this.initGalleryThumbnailSlider()}})},initGalleryThumbnailSlider(){return new o(".product-gallery-thumbnail",{modules:[d,l],slidesPerView:4,spaceBetween:10,watchSlidesProgress:!0,touchEventsTarget:"container",navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{450:{slidesPerView:6},576:{slidesPerView:7},992:{slidesPerView:6},1600:{slidesPerView:7}}})},updateGallerySlider(){this.removeAllGallerySlides(),this.product.media.length===0&&!this.hasAnyMedia?this.addGalleryEmptySlide():this.addGallerySlides(),this.addGalleryEventListeners()},addGallerySlides(){const t=[],e=[];[...this.item.media,...this.product.media].forEach(({path:i})=>{t.unshift(this.galleryPreviewSlide(i)),e.unshift(this.galleryThumbnailSlide(i))}),r.addSlide(0,t),r.thumbs.swiper.addSlide(0,e),r.slideTo(0),r.thumbs.swiper.slideTo(0)},addGalleryEmptySlide(){const t=`${FleetCart.baseUrl}/build/assets/image-placeholder.png`;r.addSlide(0,this.galleryPreviewEmptySlide(t)),r.thumbs.swiper.addSlide(0,this.galleryThumbnailEmptySlide(t))},removeAllGallerySlides(){r.removeAllSlides(),r.thumbs.swiper.removeAllSlides()},addGalleryEventListeners(){this.$nextTick(()=>{this.initGalleryPreviewZoom(),u.reload()})},initGalleryPreviewZoom(){if(this.isMobileDevice()){this.initGalleryPreviewMobileZoom();return}this.initGalleryPreviewDesktopZoom()},initGalleryPreviewMobileZoom(){this.destroyGalleryPreviewZoomInstances(),[...document.querySelectorAll(".gallery-preview-item > img")].forEach(t=>{n.push(new c(t,{namespace:"mobile-drift",inlinePane:!0,inlineOffsetY:-55,passive:!1}))})},initGalleryPreviewDesktopZoom(){this.destroyGalleryPreviewZoomInstances(),[...document.querySelectorAll(".gallery-preview-item > img")].forEach(t=>{n.push(new c(t,{inlinePane:!1,hoverBoundingBox:!0,boundingBoxContainer:document.body,paneContainer:document.querySelector(".product-gallery")}))})},destroyGalleryPreviewZoomInstances(){n.length!==0&&n.forEach(t=>{t.destroy()})},initGalleryPreviewLightbox(){return b({zoomable:!0,preload:!1})},triggerGalleryPreviewLightbox(t){window.innerWidth>990&&t.currentTarget.nextElementSibling.click()},galleryPreviewSlide(t){return`
                <div class="swiper-slide">
                    <div class="gallery-preview-slide">
                        <div class="gallery-preview-item" @click="triggerGalleryPreviewLightbox(event)">
                            <img src="${t}" data-zoom="${t}" alt="${this.productName}">
                        </div>

                        <a href="${t}" data-gallery="product-gallery-preview" class="gallery-view-icon glightbox">
                            <i class="las la-search-plus"></i>
                        </a>
                    </div>
                </div>
            `},galleryThumbnailSlide(t){return`
                <div class="swiper-slide">
                    <div class="gallery-thumbnail-slide">
                        <div class="gallery-thumbnail-item">
                            <img src="${t}" alt="${this.productName}">
                        </div>
                    </div>
                </div>
            `},galleryPreviewEmptySlide(t){return`
                <div class="swiper-slide">
                    <div class="gallery-preview-slide">
                        <div class="gallery-preview-item" @click="triggerGalleryPreviewLightbox(event)">
                            <img src="${t}" data-zoom="${t}" alt="${this.productName}" class="image-placeholder">
                        </div>

                        <a href="${t}" data-gallery="product-gallery-preview" class="gallery-view-icon glightbox">
                            <i class="las la-search-plus"></i>
                        </a>
                    </div>
                </div>
            `},galleryThumbnailEmptySlide(t){return`
                <div class="swiper-slide">
                    <div class="gallery-thumbnail-slide">
                        <div class="gallery-thumbnail-item">
                            <img src="${t}" alt="${this.productName}" class="image-placeholder">
                        </div>
                    </div>
                </div>
            `},isVariationValueEnabled(t,e,i){if(e===0)return this.doesVariantExist(i);if(e>0&&e<this.product.variations.length-1)return this.doesVariantExist(i);if(e===this.product.variations.length-1){const s=this.cartItemForm.variations,a=Object.values(s).filter(v=>v!==s[t]);return a.push(i),this.doesVariantExist(a.sort().join("."))}},setActiveVariationsValue(){this.hasAnyVariant&&this.item.uids.split(".").forEach(t=>{this.product.variations.some(e=>{const i=e.values.find(s=>s.uid===t);if(i!==void 0)return this.activeVariationValues[e.uid]=i.label,this.cartItemForm.variations[e.uid]=t,!0})})},setActiveVariationValueLabel(t){this.variationImagePath=null;const e=this.product.variations[t],i=e.values.find(s=>s.uid===this.cartItemForm.variations[e.uid]);this.activeVariationValues[e.uid]=i.label},setVariationValueLabel(t,e){const i=this.product.variations[t],s=i.values[e];!this.isMobileDevice()&&i.type==="image"&&(this.variationImagePath=s.image.path),this.activeVariationValues[i.uid]=s.label},isActiveVariationValue(t,e){return this.cartItemForm.variations.hasOwnProperty(t)?this.cartItemForm.variations[t]===e:!1},syncVariationValue(t,e,i,s){this.isActiveVariationValue(t,i)||(this.cartItemForm.variations[t]=i,this.setVariationValueLabel(e,s),this.updateVariantDetails())},doesVariantExist(t){return this.product.variants.some(({uids:e})=>e.includes(t))},setVariant(){const t=Object.values(this.cartItemForm.variations).sort().join("."),e=this.product.variants.find(s=>s.uids===t);if(e!==void 0){this.item={...e},this.reduceToMaxQuantity();return}const i=f(Object.values(this.cartItemForm.variations).sort().join("."));this.item={uid:i,media:[],base_image:[]},this.cartItemForm.qty=1},setVariantSlug(){const t=route("products.show",{slug:this.product.slug,variant:this.item.uid});window.history.replaceState({},"",t)},updateVariantDetails(){this.setOldMediaLength(),this.setVariant(),this.setVariantSlug(),this.updateGallerySlider()},updateSelectTypeOptionValue(t,e){this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[t]:e.target.value}),this.errors.clear(`options.${t}`)},updateCheckboxTypeOptionValue(t,e){let i=$(e.target).parents(".variant-check").find('input[type="checkbox"]:checked').map((s,a)=>a.value);this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[t]:i.get()})},customRadioTypeOptionValueIsActive(t,e){return this.cartItemForm.options.hasOwnProperty(t)?this.cartItemForm.options[t]===e:!1},syncCustomRadioTypeOptionValue(t,e){this.customRadioTypeOptionValueIsActive(t,e)?delete this.cartItemForm.options[t]:(this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[t]:e}),this.errors.clear(`options.${t}`))},customCheckboxTypeOptionValueIsActive(t,e){return this.cartItemForm.options.hasOwnProperty(t)?this.cartItemForm.options[t].includes(e):(this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[t]:[]}),!1)},syncCustomCheckboxTypeOptionValue(t,e){this.customCheckboxTypeOptionValueIsActive(t,e)?this.cartItemForm.options[t].splice(this.cartItemForm.options[t].indexOf(e),1):(this.cartItemForm.options[t].push(e),this.cartItemForm=Object.assign({},this.cartItemForm,this.cartItemForm.options),this.errors.clear(`options.${t}`))},setDescriptionContentHeight(){this.$nextTick(()=>{this.showMore=this.$refs.descriptionContent.clientHeight>=400})},setInactiveItemData(){this.item={uid:this.item.uid,media:[],base_image:[]}},isMobileDevice(){return window.matchMedia("only screen and (max-width: 992px)").matches},updateQuantity(t){if(isNaN(t)||t<1){this.cartItemForm.qty=1;return}if(this.cartItemForm.qty=t,this.exceedsMaxStock(t)){this.cartItemForm.qty=this.item.qty;return}},exceedsMaxStock(t){return this.doesManageStock&&this.item.qty<t},reduceToMaxQuantity(){this.doesManageStock&&this.cartItemForm.qty>this.item.qty&&(this.cartItemForm.qty=this.item.qty||1)},addToCart(){this.isAddToCartDisabled||(this.addingToCart=!0,axios.post(route("cart.items.store"),{...this.cartItemForm,...this.hasAnyVariant&&{variant_id:this.item.id}}).then(t=>{this.$store.state.updateCart(t.data),this.$store.layout.openSidebarCart()}).catch(({response:t})=>{t.status===422&&this.errors.record(t.data.errors),notify(t.data.message)}).finally(()=>{this.addingToCart=!1}))},toggleDescriptionContent(){this.showDescriptionContent=!this.showDescriptionContent},async fetchReviews(){this.fetchingReviews=!0;try{const t=await axios.get(route("products.reviews.index",{productId:this.product.id,page:this.currentPage}));this.reviews=t.data}catch(t){notify(t.response.data.message)}finally{this.fetchingReviews=!1}},addNewReview(){this.addingNewReview=!0,axios.post(route("products.reviews.store",{productId:this.product.id}),{...this.reviewForm,...window.grecaptcha&&{"g-recaptcha-response":grecaptcha.getResponse()}}).then(t=>{this.reviewForm={},this.reviews.total++,this.reviews.data.unshift(t.data),notify(trans("storefront::product.review_submitted")),this.errors.reset()}).catch(({response:t})=>{if(t.status===422){this.errors.record(t.data.errors);return}notify(t.data.message)}).finally(()=>{this.addingNewReview=!1,window.grecaptcha&&grecaptcha.reset()})},changePage(t){this.currentPage=t,this.fetchReviews()},hideRelatedProductsSkeleton(){document.querySelectorAll(".landscape-products .swiper-slide-skeleton").forEach(e=>e.remove())},initUpSellProductsSlider(){new o(this.$refs.upSellProducts,{modules:[l],slidesPerView:1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})},initRelatedProductsSlider(){this.hideRelatedProductsSkeleton(),new o(this.$refs.landscapeProducts,{modules:[l,w],slidesPerView:2,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",dynamicBullets:!0,clickable:!0},breakpoints:{640:{slidesPerView:3},880:{slidesPerView:4},992:{slidesPerView:3},1100:{slidesPerView:4},1300:{slidesPerView:5},1600:{slidesPerView:6}}})}}));
